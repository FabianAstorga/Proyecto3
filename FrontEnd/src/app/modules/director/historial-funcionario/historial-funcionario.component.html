<app-layout [title]="'Director'" [logoutLink]="'/login'" *ngIf="user">
  <div class="p-6 bg-white rounded-lg shadow space-y-4">
    <h2 class="text-xl font-semibold">Historial de Funcionario</h2>

    <!-- Selección de funcionario -->
    <div>
      <label for="funcionario" class="block mb-1 font-medium"
        >Funcionario:</label
      >
      <select
        id="funcionario"
        [(ngModel)]="funcionarioSeleccionadoId"
        (change)="seleccionarFuncionario()"
        class="border rounded px-2 py-1 w-full"
      >
        <option [ngValue]="null">-- Seleccionar --</option>
        <option *ngFor="let u of usuarios" [ngValue]="u.id">
          {{ u.firstName }} {{ u.lastName }}
        </option>
      </select>
    </div>

    <!-- Filtrado por mes -->
    <div *ngIf="funcionarioSeleccionadoId">
      <label for="mes" class="block mb-1 font-medium">Mes (AAAA-MM):</label>
      <input
        type="month"
        id="mes"
        (change)="cambiarMes($event)"
        class="border rounded px-2 py-1 w-full"
      />
    </div>

    <!-- Tabla de historial -->
    <table *ngIf="actividadesFiltradas.length" class="w-full border-collapse">
      <thead>
        <tr class="bg-gray-200">
          <th class="border px-2 py-1">Fecha</th>
          <th class="border px-2 py-1">Título</th>
          <th class="border px-2 py-1">Detalle</th>
          <th class="border px-2 py-1">Estado</th>
          <th class="border px-2 py-1">Horas</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let a of actividadesFiltradas" class="hover:bg-gray-50">
          <td class="border px-2 py-1">{{ a.fecha }}</td>
          <td class="border px-2 py-1">{{ a.titulo }}</td>
          <td class="border px-2 py-1">{{ a.detalle }}</td>
          <td class="border px-2 py-1">{{ a.estado }}</td>
          <td class="border px-2 py-1">{{ a.horas }}</td>
        </tr>
      </tbody>
    </table>

    <p *ngIf="funcionarioSeleccionadoId && actividadesFiltradas.length === 0">
      No hay actividades para el mes seleccionado.
    </p>
  </div>
</app-layout>
