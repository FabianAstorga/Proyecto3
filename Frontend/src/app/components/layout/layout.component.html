<aside
  class="fixed inset-y-0 left-0 z-30 flex flex-col shadow transition-[width,background-color] duration-300 ease-in-out"
  (mouseenter)="onEnterSidebar()"
  (mouseleave)="onLeaveSidebar()"
  [ngClass]="isCollapsed ? 'w-24 bg-blue-900' : 'w-72 bg-blue-900'"
>
  <ng-container *ngIf="!isCollapsed; else collapsedRail">
    <!-- Usuario arriba -->
    <div
      class="flex flex-col items-center justify-center py-8 border-b border-blue-800"
    >
      <img
        [src]="user?.photoUrl || '/avatar-de-usuario.png'"
        (error)="onAvatarError($event)"
        alt="Avatar"
        class="h-20 w-20 rounded-full object-cover border border-gray-200"
      />
      <p class="text-center leading-snug">
        <span class="text-white text-2xl font-semibold">
          {{ user?.firstName }} {{ user?.lastName }}
        </span>
        <br />
        <span class="text-gray-300 text-xl">
          {{ user?.role | titlecase }}
        </span>
        <br />
        <span class="text-gray-400 text-xl truncate">
          {{ user?.email }}
        </span>
      </p>
    </div>

    <!-- Navbar -->
    <nav class="flex-1 flex flex-col justify-start p-4 space-y-5">
      <a
        *ngFor="let item of navItems; let i = index"
        [routerLink]="item.link"
        class="block px-4 py-2.5 rounded-md border border-gray-300 font-semibold text-white bg-blue-800 hover:bg-blue-700 transition-all duration-300 text-center"
        [ngStyle]="{ 'transition-delay.ms': showMenu ? 40 * (i + 1) : 0 }"
        [ngClass]="
          showMenu ? 'opacity-100 translate-x-0' : 'opacity-0 translate-x-2'
        "
      >
        {{ item.label }}
      </a>
    </nav>

    <!-- Botón de logout -->
    <div
      class="p-4 border-t border-blue-800 transition-all duration-300"
      [ngClass]="
        showMenu ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-2'
      "
    >
      <button
        type="button"
        (click)="onLogout()"
        class="w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md bg-red-600 text-white font-semibold hover:bg-red-700 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"
      >
        Cerrar Sesión
      </button>
    </div>
  </ng-container>

  <ng-template #collapsedRail>
    <!-- Sidebar colapsado -->
    <div class="flex-1 flex flex-col items-center justify-center relative">
      <img src="/logouta.png" alt="Avatar" class="h-30 w-auto mb-6" />
    </div>
  </ng-template>
</aside>

<main
  class="min-h-screen transition-[margin] duration-300 ease-in-out main-bg"
  [ngClass]="isCollapsed ? 'ml-24' : 'ml-72'"
>
  <section class="max-w-7xl mx-auto px-6 py-6">
    <ng-content></ng-content>
  </section>
</main>
