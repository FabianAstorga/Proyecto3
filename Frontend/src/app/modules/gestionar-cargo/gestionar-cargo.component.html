<app-layout [title]="'Administración'" [logoutLink]="'/login'">
  <section class="app-page space-y-8 p-6 bg-gray-50 min-h-screen">
    <!-- ================= Alerta flotante ================= -->
    <div
      *ngIf="alertMessage"
      class="fixed inset-0 flex items-center justify-center z-50 pointer-events-none"
    >
      <div
        class="backdrop-blur-md px-6 py-4 rounded-lg shadow-lg text-white max-w-xs w-full text-center pointer-events-auto animate-fadeIn"
        [ngClass]="{
          'bg-green-500/80': alertType === 'success',
          'bg-red-500/80': alertType === 'danger',
          'bg-yellow-400/80 text-black': alertType === 'warning'
        }"
      >
        <span class="font-semibold">{{ alertType | titlecase }}! </span>
        {{ alertMessage }}
      </div>
    </div>

    <!-- ================= Título Principal ================= -->
    <div class="text-center md:text-left md:mb-6">
      <h1 class="text-5xl font-extrabold text-gray-800">Gestionar cargos</h1>
      <p class="text-gray-600 mt-1 text-2xl tracking-wide">
        Cree, edite o elimine cargos del sistema
      </p>
    </div>

    <!-- ================= Contenedor Formulario + Lista ================= -->
    <div
      class="grid md:grid-cols-2 gap-6 min-h-[80vh] w-full max-w-12xl mx-auto p-4"
    >
      <!-- ================= Formulario de Cargo ================= -->
      <div class="app-card bg-white shadow-md rounded-lg overflow-hidden">
        <div
          class="app-card-header bg-yellow-400/20 px-6 py-3 border-b border-gray-200"
        >
          <h2 class="text-lg font-semibold text-gray-800">Datos del cargo</h2>
        </div>
        <div class="app-card-body p-6">
          <form
            class="grid grid-cols-1 gap-6"
            [formGroup]="form"
            (ngSubmit)="modo === 'crear' ? crear() : actualizar()"
          >
            <!-- Ocupación -->
            <div>
              <label
                for="ocupacion"
                class="block text-sm font-medium text-gray-700"
                >Ocupación</label
              >
              <input
                id="ocupacion"
                placeholder="Ingrese la ocupación"
                class="mt-1 w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-yellow-400 focus:outline-none shadow-sm"
                formControlName="ocupacion"
              />
              <p
                *ngIf="f['ocupacion'].touched && f['ocupacion'].invalid"
                class="text-xs text-red-600 mt-1"
              >
                Obligatorio.
              </p>
            </div>

            <!-- Descripción -->
            <div>
              <label
                for="descripcion"
                class="block text-sm font-medium text-gray-700"
                >Descripción</label
              >
              <textarea
                id="descripcion"
                placeholder="Ingrese una descripción del cargo"
                class="mt-1 w-full rounded-lg border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-yellow-400 focus:outline-none shadow-sm resize-none"
                formControlName="descripcion"
                rows="3"
              ></textarea>
            </div>

            <!-- Botones Crear/Actualizar y Limpiar -->
            <div class="flex flex-wrap gap-3 pt-4">
              <button
                type="submit"
                class="btn-primary shadow hover:shadow-lg transition"
              >
                {{ modo === "crear" ? "Crear" : "Actualizar" }}
              </button>
              <button
                type="button"
                (click)="resetForm()"
                class="btn-secondary shadow hover:shadow-lg transition"
              >
                Limpiar
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- ================= Tabla de Cargos ================= -->
      <div
        class="app-card bg-white shadow-md rounded-lg overflow-hidden flex flex-col"
      >
        <div
          class="app-card-header bg-yellow-400/20 px-6 py-3 border-b border-gray-200"
        >
          <h2 class="text-lg font-semibold text-gray-800">
            Cargos del sistema
          </h2>
        </div>
        <div class="app-card-body p-6 flex-1 overflow-y-auto max-h-[500px]">
          <table class="min-w-full divide-y divide-gray-200 text-sm">
            <thead class="bg-gray-50 sticky top-0">
              <tr class="text-gray-600 uppercase text-xs">
                <th class="px-4 py-2 text-left w-1/4">Ocupación</th>
                <!-- 25% ancho -->
                <th class="px-2 py-2 text-left w-1/2">Descripción</th>
                <!-- 50% ancho -->
                <th class="px-4 py-2 text-center w-1/4">Acciones</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-100">
              <tr
                *ngFor="let c of cargos()"
                class="hover:bg-gray-50 transition"
              >
                <td class="px-4 py-2">{{ c.ocupacion }}</td>
                <td
                  class="px-4 py-2 max-w-xs truncate"
                  title="{{ c.descripcion }}"
                >
                  {{ c.descripcion }}
                </td>
                <td class="px-4 py-2 text-center">
                  <div class="flex gap-2 justify-center">
                    <button
                      class="btn-secondary px-3 py-1.5 text-xs hover:bg-gray-200 transition"
                      (click)="editar(c)"
                    >
                      Editar
                    </button>
                    <button
                      class="px-3 py-1.5 rounded-md bg-red-50 text-red-700 border border-red-200 text-xs hover:bg-red-100 transition"
                      (click)="eliminar(c.id_cargo)"
                    >
                      Eliminar
                    </button>
                  </div>
                </td>
              </tr>
              <tr *ngIf="cargos().length === 0">
                <td colspan="3" class="px-4 py-6 text-center text-gray-400">
                  Sin registros
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>
</app-layout>
