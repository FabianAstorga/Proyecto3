<app-layout [logoutLink]="'/login'">
  <section class="page-container">
    <!-- CARD PRINCIPAL -->
    <div
      class="card-base overflow-hidden
             border-slate-200
             bg-white text-slate-900
             dark:border-slate-800
             dark:bg-slate-950/80 dark:text-slate-100
             shadow-[0_24px_60px_rgba(15,23,42,0.08)]
             dark:shadow-[0_24px_60px_rgba(15,23,42,0.8)] dark:backdrop-blur-sm"
    >
      <!-- HEADER -->
      <header
        class="flex flex-col gap-3 border-b border-slate-200
               px-6 py-4 lg:flex-row lg:items-center lg:justify-between lg:px-8
               bg-slate-50
               dark:border-slate-800 dark:bg-slate-950/80"
      >
        <div>
          <h1
            class="text-2xl md:text-3xl font-bold text-slate-900 dark:text-white"
          >
            Mis actividades pendientes
          </h1>
          <p class="mt-1 text-xs md:text-sm text-slate-600 dark:text-slate-300">
            Marca tus actividades como
            <strong>Realizadas</strong> o elimínalas si ya no aplican.
          </p>
        </div>

        <div class="flex items-center gap-2">
          <span
            class="inline-flex items-center rounded-full bg-amber-100 px-3 py-1 text-xs font-medium text-amber-800 border border-amber-200"
          >
            Pendientes: {{ actividadesPendientes.length }}
          </span>
        </div>
      </header>

      <!-- CONTENIDO -->
      <div class="px-4 py-4 md:px-6 md:py-6">
        <!-- Estados de carga / error -->
        <div *ngIf="loading" class="py-10 text-center text-sm text-slate-500">
          Cargando actividades pendientes…
        </div>

        <div
          *ngIf="!loading && errorMessage"
          class="py-4 text-sm text-red-600"
        >
          {{ errorMessage }}
        </div>

        <div
          *ngIf="
            !loading &&
            !errorMessage &&
            actividadesPendientes.length === 0
          "
          class="py-10 text-center text-sm text-slate-500"
        >
          No tienes actividades pendientes por el momento
        </div>

        <!-- LISTA -->
        <ul
          *ngIf="
            !loading &&
            !errorMessage &&
            actividadesPendientes.length > 0
          "
          class="divide-y divide-slate-200 dark:divide-slate-800"
        >
          <li
            *ngFor="let act of actividadesPendientes"
            class="flex flex-col gap-3 py-4 md:flex-row md:items-center md:justify-between"
          >
            <!-- Info principal -->
            <div class="flex-1 min-w-0">
              <div class="flex flex-wrap items-center gap-2">
                <span
                  class="inline-flex items-center rounded-full px-2.5 py-0.5 text-[11px] font-medium
                         bg-blue-50 text-blue-800 border border-blue-100
                         dark:bg-blue-500/10 dark:text-blue-200 dark:border-blue-500/40"
                >
                  {{ formatDMY(act.fecha) }}
                </span>

                <span
                  class="inline-flex items-center rounded-full px-2.5 py-0.5 text-[11px] font-medium
                         bg-slate-100 text-slate-800 border border-slate-200
                         dark:bg-slate-800 dark:text-slate-100 dark:border-slate-700"
                >
                  {{ act.tipo }}
                </span>

                <span
                  class="inline-flex items-center rounded-full px-2.5 py-0.5 text-[11px] font-semibold"
                  [ngClass]="statusPillClass(act.estado)"
                >
                  {{ act.estado }}
                </span>
              </div>

              <h2
                class="mt-2 text-sm md:text-base font-semibold text-slate-900 dark:text-white"
              >
                {{ act.titulo }}
              </h2>

              <p
                class="mt-1 text-xs md:text-sm text-slate-600 dark:text-slate-300 line-clamp-3"
              >
                {{ act.detalle }}
              </p>
            </div>

            <!-- Acciones -->
            <div class="flex flex-wrap gap-2 justify-start md:justify-end">
              <button
                type="button"
                (click)="marcarComoRealizada(act)"
                class="inline-flex items-center justify-center rounded-md
                       bg-emerald-600 px-3 py-2 text-xs md:text-sm font-semibold
                       text-white shadow-sm hover:bg-emerald-700
                       focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2
                       dark:ring-offset-slate-950"
              >
                Marcar como realizada
              </button>

              <button
                type="button"
                (click)="eliminarActividad(act)"
                class="inline-flex items-center justify-center rounded-md
                       border border-rose-300 bg-rose-50 px-3 py-2 text-xs md:text-sm font-semibold
                       text-rose-700 hover:bg-rose-100 hover:border-rose-400
                       dark:border-rose-500/50 dark:bg-rose-500/10 dark:text-rose-200"
              >
                Eliminar
              </button>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </section>
</app-layout>
